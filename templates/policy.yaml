# clanet Compliance Policy - Example
#
# This policy file contains recommended default rules.
# Copy and customize for your environment:
#
#   cp templates/policy.yaml my-policy.yaml
#   # Edit my-policy.yaml
#
# Then point to it in .clanet.yaml:
#   policy_file: ./my-policy.yaml
#
# Rule types:
#   pattern_deny   - Block if command matches this regex
#   pattern_allow  - Exception to pattern_deny
#   require        - Required pattern (global or scoped with require_on)
#   require_on     - Only check 'require' within this config section
#   require_in_running - Pattern must exist in running-config
#   recommend      - Best practice suggestion (WARN only, never blocks)
#   scope          - When to evaluate: config_commands | interface_config

policy:
  name: clanet-default
  version: "1.0"
  description: "Default compliance policy with industry best-practice rules"

rules:
  # === Security ===
  # Rules to prevent insecure configurations
  security:
    - id: SEC-001
      name: No plaintext passwords
      severity: CRITICAL
      description: "Passwords must use encryption (type 5/7/8/9)."
      pattern_deny: 'password \S+$'
      pattern_allow: 'password \d+ \S+'

    - id: SEC-002
      name: SSH v2 required
      severity: HIGH
      description: "SSH version 2 must be enabled."
      require_in_running: 'ssh.*v(ersion)?\s*2'

  # === Operational Safety ===
  # Rules to prevent accidental outages
  safety:
    - id: SAF-001
      name: Management interface protection
      severity: CRITICAL
      description: "Management interface must not be modified or shut down."
      pattern_deny: '(no )?interface Mgmt|shutdown.*Mgmt'
      scope: config_commands

    - id: SAF-002
      name: No bulk protocol removal
      severity: CRITICAL
      description: "Removing an entire routing protocol is prohibited."
      pattern_deny: 'no router (ospf|bgp|isis|eigrp)'

  # === Standards ===
  # Baseline configuration requirements
  standards:
    - id: STD-001
      name: NTP configured
      severity: MEDIUM
      description: "At least one NTP server must be configured."
      require_in_running: 'ntp server'

    - id: STD-002
      name: Logging configured
      severity: MEDIUM
      description: "A syslog destination must be configured."
      require_in_running: 'logging.*\d+\.\d+\.\d+\.\d+'

severity_levels:
  CRITICAL: "Must fix. Blocks deployment."
  HIGH: "Should fix. Requires explicit override to proceed."
  MEDIUM: "Recommended. Warning only."
  LOW: "Best practice. Informational."
